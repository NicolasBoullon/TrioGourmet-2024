<app-header title="Encuesta satisfacción" backButton="/home"></app-header>

<ion-content [fullscreen]="true" class="encuestas-content">
  <ion-grid>
    <ion-row>
      <ion-col size="12">
        <h2 style="font-size: 2rem;">Opiniones de Nuestros Clientes</h2>
        <p style="font-size: 1.6rem;">Explora las encuestas completadas para conocer la experiencia de nuestros clientes y ayudarnos a mejorar cada día.</p>
      </ion-col>
    </ion-row>

    @if(userDoc?.estado) {
      <ion-row>
        <ion-col size="12" class="centered">
          <ion-button expand="block" color="primary" routerLink="/graficos-encuestas" style="font-size: 1.5rem;">
            Gráficos Encuestas
          </ion-button>
        </ion-col>
      </ion-row>
    }
    
    @if(userDoc?.estado === 'pedido entregado' || userDoc?.estado === 'cuenta solicitada'  || userDoc?.estado === 'cuenta enviada'  || userDoc?.estado === 'cuenta pagada') {
      <ion-row>
        <ion-col size="12" class="centered">
          <ion-button expand="block" color="primary" (click)="crearEncuesta()">
            Realizar Encuesta
          </ion-button>
        </ion-col>
      </ion-row>
    }

    <ion-row>
      <ion-col size="12">
        <ion-list>
          @for (encuesta of encuestas; track $index) {
            <ion-card color="light" class="encuesta-card">
              <ion-card-header color="secondary">
                <ion-card-title>{{ encuesta.fecha | date: 'dd/MM - HH:mm'}}</ion-card-title>
                <ion-card-subtitle style="font-size: 1.3rem;">Calificación General: {{ encuesta.calificacionGeneral }}</ion-card-subtitle>
              </ion-card-header>
              <ion-card-content>
                <p style="font-size: 1.1rem;"><strong>Calidad de la comida:</strong> {{ encuesta.calidadComida }}</p>
                <p style="font-size: 1.1rem;"><strong>Tiempo de espera:</strong> {{ encuesta.tiempoEspera }}</p>
                <p style="font-size: 1.1rem;"><strong>Amabilidad del personal:</strong> {{ encuesta.amabilidadPersonal }}</p>
                <p style="font-size: 1.1rem;"><strong>Limpieza:</strong> {{ getLimpiezaText(encuesta.limpieza)}}</p>
              </ion-card-content>
              @if(encuesta.fotos && encuesta.fotos.length > 0) {
                <swiper-container class="foto-slider" [loop]="true" [pagination]="true" [zoom]="true">
                  @for(foto of encuesta.fotos; track $index) {
                    <swiper-slide>
                      <div class="swiper-zoom-container">
                        <img [src]="foto" alt="Foto de la encuesta" />
                      </div>
                    </swiper-slide>
                  }
                </swiper-container>
              }
            </ion-card>
          } @empty {
            <app-loading></app-loading>
          }
        </ion-list>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
